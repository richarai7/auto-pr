# MySQL Performance Configuration Template
# ============================================================================
# This configuration file provides optimized MySQL settings for enterprise
# workloads. Adjust values based on your specific hardware and requirements.
#
# Author: MySQL Architecture Team
# Version: 1.0
# Last Updated: 2024
# ============================================================================

[mysqld]
# ============================================================================
# Basic Settings
# ============================================================================
user = mysql
port = 3306
bind-address = 0.0.0.0
socket = /var/run/mysqld/mysqld.sock
pid-file = /var/run/mysqld/mysqld.pid

# Data directory
datadir = /var/lib/mysql
tmpdir = /tmp

# ============================================================================
# Character Set and Collation
# ============================================================================
character-set-server = utf8mb4
collation-server = utf8mb4_unicode_ci
init-connect = 'SET NAMES utf8mb4'

# ============================================================================
# Connection Settings
# ============================================================================
# Maximum number of concurrent connections
max_connections = 200

# Connection timeout settings
wait_timeout = 28800
interactive_timeout = 28800
connect_timeout = 10

# Maximum allowed packet size (increase for large data imports)
max_allowed_packet = 64M

# ============================================================================
# InnoDB Storage Engine Configuration
# ============================================================================
# Set to 70-80% of available RAM for dedicated MySQL server
innodb_buffer_pool_size = 2G

# InnoDB log settings for crash recovery and performance
innodb_log_file_size = 256M
innodb_log_buffer_size = 64M

# Flush settings for durability vs performance trade-off
# 1 = full ACID compliance (safest)
# 2 = good balance (recommended for most cases)
# 0 = fastest but less safe
innodb_flush_log_at_trx_commit = 2

# File format and row format
innodb_file_format = Barracuda
innodb_file_per_table = 1
innodb_large_prefix = 1

# Thread concurrency
innodb_thread_concurrency = 0
innodb_read_io_threads = 8
innodb_write_io_threads = 8

# Purge threads for cleanup operations
innodb_purge_threads = 4

# ============================================================================
# Query Cache Configuration
# ============================================================================
# Enable query cache for repeated SELECT queries
query_cache_type = 1
query_cache_size = 64M
query_cache_limit = 2M

# ============================================================================
# MyISAM Storage Engine Configuration
# ============================================================================
# Key buffer for MyISAM tables (set lower if using primarily InnoDB)
key_buffer_size = 16M

# Table cache
table_open_cache = 2000
table_definition_cache = 1400

# ============================================================================
# Temporary Tables and Memory
# ============================================================================
tmp_table_size = 64M
max_heap_table_size = 64M

# Sort and join buffer sizes
sort_buffer_size = 2M
join_buffer_size = 2M
read_buffer_size = 128K
read_rnd_buffer_size = 256K

# ============================================================================
# Binary Logging (for replication and point-in-time recovery)
# ============================================================================
# Enable binary logging
log-bin = mysql-bin
binlog_format = ROW
binlog_row_image = FULL

# Binary log retention (adjust based on backup frequency)
expire_logs_days = 7

# Sync binary log for durability
sync_binlog = 1

# ============================================================================
# Slow Query Log
# ============================================================================
# Enable slow query logging for performance analysis
slow_query_log = 1
slow_query_log_file = /var/log/mysql/slow.log
long_query_time = 1

# Log queries not using indexes
log_queries_not_using_indexes = 1
min_examined_row_limit = 1000

# ============================================================================
# General Log (disable in production for performance)
# ============================================================================
# general_log = 0
# general_log_file = /var/log/mysql/general.log

# ============================================================================
# Error Log
# ============================================================================
log-error = /var/log/mysql/error.log
log_warnings = 2

# ============================================================================
# SQL Mode for strict compliance
# ============================================================================
sql_mode = STRICT_TRANS_TABLES,NO_ZERO_DATE,NO_ZERO_IN_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION

# ============================================================================
# Security Settings
# ============================================================================
# Disable local file loading for security
local_infile = 0

# Skip name resolution for better performance and security
skip_name_resolve = 1

# ============================================================================
# Performance Schema (MySQL 5.6+)
# ============================================================================
performance_schema = ON
performance_schema_max_table_instances = 12500
performance_schema_max_table_handles = 4000

# ============================================================================
# Replication Settings (for slave servers)
# ============================================================================
# Uncomment and configure for replication slaves
# server-id = 2
# relay-log = mysql-relay-bin
# read_only = 1
# log_slave_updates = 1

# ============================================================================
# SSL Configuration
# ============================================================================
# Uncomment and configure SSL certificates for encrypted connections
# ssl-ca = /etc/mysql/ssl/ca-cert.pem
# ssl-cert = /etc/mysql/ssl/server-cert.pem
# ssl-key = /etc/mysql/ssl/server-key.pem

# Require SSL for all connections (optional)
# require_secure_transport = ON

# ============================================================================
# Client Configuration
# ============================================================================
[mysql]
default-character-set = utf8mb4

[mysqldump]
single-transaction
routines
triggers
events

[client]
default-character-set = utf8mb4
# Uncomment for SSL client connections
# ssl-ca = /etc/mysql/ssl/ca-cert.pem
# ssl-cert = /etc/mysql/ssl/client-cert.pem
# ssl-key = /etc/mysql/ssl/client-key.pem

# ============================================================================
# Hardware-Specific Optimizations
# ============================================================================
# For SSD storage
# innodb_flush_neighbors = 0
# innodb_io_capacity = 2000
# innodb_io_capacity_max = 4000

# For traditional spinning disks
# innodb_flush_neighbors = 1
# innodb_io_capacity = 200
# innodb_io_capacity_max = 400

# ============================================================================
# Notes for Tuning
# ============================================================================
# 1. innodb_buffer_pool_size: Set to 70-80% of RAM on dedicated MySQL servers
# 2. max_connections: Monitor actual usage and adjust accordingly
# 3. Query cache: Disable (query_cache_type = 0) if using MySQL 8.0+
# 4. Binary logging: Essential for replication and point-in-time recovery
# 5. Slow query log: Critical for identifying performance bottlenecks
# 6. SQL mode: Use strict mode to ensure data integrity
# 7. Character set: utf8mb4 is recommended for full Unicode support
# 8. SSL: Enable for production environments with sensitive data
# 9. Performance Schema: Useful for detailed performance analysis
# 10. Regular monitoring: Use tools like MySQL Workbench, Percona Toolkit